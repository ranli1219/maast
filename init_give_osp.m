function init_give_osp()
%*************************************************************************
%*     Copyright c 2001 The board of trustees of the Leland Stanford     *
%*                      Junior University. All rights reserved.          *
%*     The algorithms in this script file may contain elements           *
%*     considered proprietary by Raytheon. This file shall not be        *
%*     disclosed to the public, to any vendor not identified as a        *
%*     consultant subcontractor to the FAA or the prime contractor       *
%*     (Raytheon), or to any other government (or government agency) not *
%*     participating in WAAS without the prior written permission of the *
%*     FAA WAAS Contracting Officer                                      *
%*                                                                       *
%*     Questions and comments should be directed to Todd Walter at:      *
%*     twalter@stanford.edu                                              *
%*************************************************************************
%
%function init_give_osp()

%modified 05 Nov 2001 by Todd Walter

global GIVE_CHI2_PFA GIVE__CHI2_PMD
global GIVE_SIG2_DECORR GIVE_CHI2_THRESH GIVE_R2_IRREG 
global GIVE_N_MIN GIVE_N_PTS GIVE_RMAX GIVE_RMIN GIVE_R2_DYN_IRREG
global GIVE_UNDERSAMP_PTS
global GIVE_SIG2_ROT0
global GIVE_KHMI_KA GIVE_GIVEI_FLOOR
global GIVE_KIGD_FAC GIVE_CEILING_P GIVE_CEILING_T GIVE_CEILING_LAT
global GIVE_SIG2_L1L2REC GIVE_SIG2_L1L2SAT
global RTR_FLAG RTR_MULT TRUTH_FLAG IPP_SPREAD_FLAG BRAZPARAMS


GIVE_CHI2_PFA=10^(-3);
GIVE_CHI2_PMD=(2.25*10^(-4));
if BRAZPARAMS
    GIVE_SIG2_DECORR=2^2;
else
    GIVE_SIG2_DECORR=(0.35)^2;
end;
fprintf('Sig2 Decorr = %f\n', GIVE_SIG2_DECORR);

GIVE_CHI2_THRESH = chi2inv(1-GIVE_CHI2_PFA,1:100)';
GIVE_R2_IRREG=GIVE_CHI2_THRESH./(chi2inv(GIVE_CHI2_PMD,1:100)');
GIVE_R2_DYN_IRREG=1./chi2inv(.000001,1:100);

GIVE_N_MIN=10;
GIVE_N_PTS=30;
GIVE_RMAX=2100000;
GIVE_RMIN=800000;

% Real Time R-irreg
if RTR_FLAG
    load('RTR_MULT.mat');
    fprintf('Real Time R-irreg being used\n');
else
    fprintf('Normal R-irreg being used\n');
end;

% The following critical points are from the threat model created by M.
% DeLand implementing Larry's IPP spread metric.
if IPP_SPREAD_FLAG
    fprintf('IPP Spread Metric being used\n');
    % A = 10, R = 424
%     GIVE_UNDERSAMP_PTS = [[0.700 2100 6.0458];...
%             [0.675 2100 6.0005];...
%             [0.650 2100 5.7639];...
%             [0.625 2100 4.0025];...
%             [0.600 2100 3.9821];...
%             [0.500 2100 3.8921];...
%             [0.500 1950 2.7457];...
%             [0.525 1800 2.5633];...
%             [0.425 2100 2.4534];...
%             [0.475 1700 2.4165];...
%             [0.475 1650 2.3905];...
%             [0.500 1600 1.7437];...
%             [0.450 1550 1.7432];...
%             [0.450 1500 1.7032];...
%             [0.400 1450 1.6910];...
%             [0.375 1400 1.6771];...
%             [0.325 1150 1.0917];...
%             [0.275 2100 0.8580];...
%             [0.250 1250 0.6658];...
%             [0.275 1200 0.6549];...
%             [0.100 2100 0.6545];...
%             [0.200 1150 0.5759];...
%             [0.000 1100 0.5358];...
%             [0.025 1050 0.4124];...
%             [0.000  950 0.3503];...
%             [0.000  900 0.2649];...
%             [0.000  850 0.2615];...
%             [0.000  800 0.2613];...
%             [0.000    0 0.0000]];
%         
    
    
    % A = 7 2s
    GIVE_UNDERSAMP_PTS = [[0.675 2100 6.0458];...
           [0.650 2100 6.0005];...
           [0.625 2100 5.7639];...
           [0.600 2100 4.0251];...
           [0.575 2100 3.9821];...
           [0.500 2100 3.8921];...
           [0.475 1950 2.7457];...
           [0.500 1800 2.5633];...
           [0.425 2100 2.4534];...
           [0.475 1700 2.4165];...
           [0.475 1650 2.3905];...
           [0.475 1600 1.7437];...
           [0.425 1550 1.7432];...
           [0.425 1500 1.7032];...
           [0.375 1450 1.6910];...
           [0.375 1400 1.6771];...
           [0.325 1150 1.0917];...
           [0.300 2100 0.8580];...
           [0.275 2100 0.8040];...
           [0.250 1250 0.6658];...
           [0.275 1200 0.6549];...
           [0.150 2100 0.6545];...
           [0.175 1150 0.5759];...
           [0.000 1100 0.5358];...
           [0.025 1050 0.4124];...
           [0.000 1050 0.4093];...
           [0.000  950 0.3503];...
           [0.000  900 0.2649];...
           [0.000  850 0.2615];...
           [0.000  800 0.2613];...
           [0.000    0 0.0000]];
    % A = 6 3s Overlap
    %GIVE_UNDERSAMP_PTS = [[0.625 2100 6.0458];...
    %        [0.600 2100 6.0005];...
    %        [0.575 2100 5.7639];...
    %        [0.550 2100 3.9821];...
    %        [0.450 2100 3.8921];...
    %        [0.450 1950 2.7457];...
    %        [0.450 1800 2.5633];...
    %        [0.425 2100 2.4534];...
    %        [0.425 1700 2.4165];...
    %        [0.425 1650 2.3905];...
    %        [0.425 1600 1.7437];...
    %        [0.400 1550 1.7432];...
    %        [0.375 1500 1.7032];...
    %        [0.350 1450 1.6910];...
    %        [0.325 1400 1.6771];...
    %        [0.275 1150 1.0917];...
    %        [0.225 1250 0.6658];...
    %        [0.150 2100 0.6545];...
    %        [0.250 1200 0.6543];...
    %        [0.175 1150 0.5759];...
    %        [0.000 1100 0.5358];...
    %        [0.000 1050 0.4124];...
    %        [0.000  950 0.3503];...
    %        [0.000  900 0.2649];...
    %        [0.000  850 0.2615];...
    %        [0.000  800 0.2613];...
    %        [0.000    0 0.0000]];
    % A = 5
    %GIVE_UNDERSAMP_PTS = [[0.550 2100 6.0458];...
    %        [0.525 2100 6.0005];...
    %        [0.500 2100 5.7639];...
    %        [0.475 2100 3.9821];...
    %        [0.375 2100 3.8921];...
    %        [0.375 1950 2.7457];...
    %        [0.375 1800 2.5633];...
    %        [0.325 2100 2.4534];...
    %        [0.350 1700 2.4165];...
    %        [0.350 1650 2.3905];...
    %        [0.350 1600 1.7437];...
    %        [0.300 1550 1.7432];...
    %        [0.300 1500 1.7032];...
    %        [0.275 1450 1.6910];...
    %        [0.250 1400 1.6771];...
    %        [0.200 1150 1.0917];...
    %        [0.175 2100 0.8580];...
    %        [0.150 1250 0.6658];...
    %        [0.175 1200 0.6549];...
    %        [0.050 2100 0.6545];...
    %        [0.025 2100 0.6505];...
    %        [0.150 1200 0.5903];...
    %        [0.075 1150 0.5759];...
    %        [0.000 1100 0.5358];...
    %        [0.000 1050 0.4124];...
    %        [0.000  950 0.3503];...
    %        [0.000  900 0.2649];...
    %        [0.000  850 0.2615];...
    %        [0.000  800 0.2613];...
    %        [0.000    0 0.0000]];
    % A = 6
    %GIVE_UNDERSAMP_PTS = [[0.625 2100 6.0458];...
    %        [0.600 2100 6.0005];...
    %        [0.575 2100 5.7639];...
    %        [0.550 2100 3.9990];...
    %        [0.525 2100 3.9821];...
    %        [0.450 2100 3.8921];...
    %        [0.425 1950 2.7457];...
    %        [0.450 1800 2.5633];...
    %        [0.375 2100 2.4534];...
    %        [0.425 1700 2.4165];...
    %        [0.425 1650 2.3905];...
    %        [0.425 1600 1.7437];...
    %        [0.375 1550 1.7432];...
    %        [0.375 1500 1.7032];...
    %        [0.325 1450 1.6910];...
    %        [0.325 1400 1.6771];...
    %        [0.275 1150 1.0917];...
    %        [0.250 2100 0.8580];...
    %        [0.225 1250 0.6658];...
    %        [0.225 1200 0.6549];...
    %        [0.100 2100 0.6545];...
    %        [0.150 1150 0.5759];...
    %        [0.125 1150 0.5483];...
    %        [0.000 1100 0.5358];...
    %        [0.000 1050 0.4124];...
    %        [0.000  950 0.3503];...
    %        [0.000  900 0.2649];...
    %        [0.000  850 0.2615];...
    %        [0.000  800 0.2613];...
    %        [0.000    0 0.0000]];
    
    % A = 16
    %GIVE_UNDERSAMP_PTS = [[0.825 2100 6.0458];...
    %    [0.800 2100 6.0005];...
    %    [0.775 2100 4.1324];...
    %    [0.750 2100 3.9821];...
    %    [0.650 2100 3.8921];...
    %    [0.650 1950 2.7457];...
    %    [0.650 1800 2.5633];...
    %    [0.600 2100 2.4534];...
    %    [0.625 1700 2.4165];...
    %    [0.625 1650 2.3905];...
    %    [0.625 1600 1.7437];...
    %    [0.600 1550 1.7432];...
    %    [0.575 1500 1.7032];...
    %    [0.550 1450 1.6910];...
    %    [0.525 1450 1.6815];...
    %    [0.525 1400 1.6771];...
    %    [0.475 1150 1.0917];...
    %    [0.450 2100 0.8580];...
    %    [0.425 1250 0.6658];...
    %    [0.450 1200 0.6549];...
    %    [0.325 2100 0.6545];...
    %    [0.425 1200 0.5903];...
    %    [0.350 1150 0.5759];...
    %    [0.200 1100 0.5358];...
    %    [0.150 1150 0.5102];...
    %    [0.175 1100 0.4140];...
    %    [0.175 1050 0.4124];...
    %    [0.150 1100 0.3580];...
    %    [0.075  950 0.3503];...
    %    [0.050 1150 0.3367];...
    %    [0.025  950 0.2776];...
    %    [0.000  950 0.2760];...
    %    [0.000  900 0.2649];...
    %    [0.075  850 0.2615];...
    %    [0.050  800 0.2613];...
    %    [0.025  800 0.2163];...
    %    [0.000  800 0.2047];...
    %    [0.000    0 0.0000]];
    % A = 12
    %GIVE_UNDERSAMP_PTS = [[0.775 2100 6.0458];...
    %        [0.750 2100 5.7639];...
    %        [0.725 2100 4.0251];...
    %        [0.700 2100 3.9821];...
    %        [0.600 2100 3.8921];...
    %        [0.600 1950 2.7457];...
    %        [0.625 1800 2.5633];...
    %        [0.600 1800 2.4566];...
    %        [0.550 2100 2.4534];...
    %        [0.600 1700 2.4165];...
    %        [0.600 1650 2.3905];...
    %        [0.600 1600 1.7437];...
    %        [0.550 1550 1.7432];...
    %        [0.550 1500 1.7032];...
    %        [0.500 1450 1.6910];...
    %        [0.500 1400 1.6771];...
    %        [0.450 1150 1.0917];...
    %        [0.400 2100 0.8580];...
    %        [0.375 1250 0.6658];...
    %        [0.400 1200 0.6549];...
    %        [0.275 2100 0.6545];...
    %        [0.300 1150 0.5759];...
    %        [0.125 1100 0.5358];...
    %        [0.050 1150 0.5102];...
    %        [0.150 1050 0.4124];...
    %        [0.125 1050 0.4093];...
    %        [0.100 1100 0.3580];...
    %        [0.025  950 0.3503];...
    %        [0.000 1150 0.3367];...
    %        [0.000  950 0.2776];...
    %        [0.000  900 0.2649];...
    %        [0.050  850 0.2615];...
    %        [0.000  800 0.2613];...
    %        [0.000    0 0.0000]];
    % A = 8
    %GIVE_UNDERSAMP_PTS=[[0.700 2100 6.0458];...
    %        [0.675 2100 6.0005];...
    %        [0.650 2100 5.7639];...
    %        [0.625 2100 3.9821];...
    %        [0.525 2100 3.8921];...
    %        [0.525 1950 2.7457];...
    %        [0.525 1800 2.5633];...
    %        [0.475 2100 2.4534];...
    %        [0.500 1700 2.4165];...
    %        [0.500 1650 2.3905];...
    %        [0.500 1600 1.7437];...
    %        [0.450 1550 1.7432];...
    %        [0.450 1500 1.7032];...
    %        [0.425 1450 1.6910];...
    %        [0.400 1400 1.6771];...
    %        [0.350 1150 1.0917];...
    %        [0.325 2100 0.8580];...
    %        [0.300 1250 0.6658];...
    %        [0.325 1200 0.6549];...
    %        [0.200 2100 0.6545];...
    %        [0.175 2100 0.6505];...
    %        [0.300 1200 0.5903];...
    %        [0.225 1150 0.5759];...
    %        [0.025 1100 0.5358];...
    %        [0.000 1150 0.5102];...
    %        [0.050 1050 0.4124];...
    %        [0.000  950 0.3503];...
    %        [0.000  900 0.2649];...
    %        [0.000  850 0.2615];...
    %        [0.000  800 0.2613];...
    %        [0.000    0 0.0000]];
                        
else
    fprintf('Relative Centroid Metric being used\n');
    % rcm, shell height = 350
    GIVE_UNDERSAMP_PTS=[[0.000 800 0.0807];... 
                        [0.000 850 0.1206];...
                        [0.000 950 0.2282];...
                        [0.025 800 0.1447];...
                        [0.025 850 0.1861];...
                        [0.025 900 0.2228];...
                        [0.025 950 0.2371];...
                        [0.025 1950 0.3346];...
                        [0.025 2000 0.3693];...
                        [0.050 800 0.17];...
                        [0.075 800 0.1754];...
                        [0.075 1150 0.2865];...
                        [0.100 800 0.2144];...
                        [0.125 950 0.3012];...
                        [0.175 1750 0.4356];...
                        [0.200 1150 0.4484];...
                        [0.250 1050 0.3649];...
                        [0.250 2100 0.6535];...
                        [0.300 2100 1.1445];...
                        [0.325 1100 0.4737];...
                        [0.350 1900 0.6848];...
                        [0.350 2100 1.3183];...
                        [0.375 2100 1.7327];...
                        [0.400 1150 0.4782];...
                        [0.400 2100 2.2893];...
                        [0.425 1150 0.5047];...
                        [0.425 1550 0.6237];...
                        [0.450 1400 0.7231];...
                        [0.450 1750 1.3102];...
                        [0.475 1250 0.5694];...
                        [0.475 1550 0.7378];...
                        [0.475 2100 3.0186];...
                        [0.500 1400 1.5028];...
                        [0.500 2100 3.3328];...
                        [0.525 1150 0.6778];...
                        [0.525 1450 1.516];...
                        [0.525 1500 1.5263];...
                        [0.525 1950 2.2065];...
                        [0.550 1700 2.1862];...
                        [0.550 1800 2.2219];...
                        [0.550 2100 3.3841];...
                        [0.575 1150 0.7968];...
                        [0.575 1300 0.8369];...
                        [0.575 1550 1.5577];...
                        [0.575 1600 1.5632];...
                        [0.575 1650 2.1615];...
                        [0.575 1950 2.4845];...
                        [0.575 2100 3.4949];...
                        [0.600 1350 0.8675];...
                        [0.600 1800 2.317];...
                        [0.600 2100 3.701];...
                        [0.625 1150 0.9699];...
                        [0.625 2100 5.1842];...
                        [0.675 2100 5.2862]];
        
    end;
                
                    
GIVE_SIG2_ROT0=(1.62/5.33)^2;

GIVE_KHMI_KA=5.592/5.33;

GIVE_KIGD_FAC=1/5.33;
GIVE_CEILING_P=[[24.3 9.72]; [24.3 24.3]; [72.9 9.72]; [24.3 9.72]]';
GIVE_CEILING_T=[[6 7]; [10 22]; [23 23]; [24 24]]'*3600;
GIVE_CEILING_LAT=50;

GIVE_SIG2_L1L2REC = (0.229)^2;
GIVE_SIG2_L1L2SAT = (0.192)^2;

GIVE_GIVEI_FLOOR = 10;  %GIVE floor set to 3 m
%GIVE_GIVEI_FLOOR = 0; % Run for Juan


